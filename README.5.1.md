# Домашнее задание к занятию "Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."

> Опишите кратко, как вы поняли: в чем основное отличие полной
> (аппаратной) виртуализации, паравиртуализации и виртуализации на
> основе ОС.

Можно сказать, в уровне, на котором происходит изоляция виртуальных
машин друг от друга и от физических ресурсов. При аппаратной
виртуализации используются средства оборудования (для нас сейчас
актуальны VT-d, AMD-V), при контейнеризации/виртуализации на уровне ОС
их наличие (в общем случае) не обязательно. Например, Docker, в
принципе, может работать на машинах без VT-d или AMD-V. Но Docker для
Windows потребует включения Hyper-V.

> Выберите один из вариантов использования организации физических
> серверов, в зависимости от условий использования.

- Высоконагруженная база данных, чувствительная к отказу.

В таком сценарии, вероятно, физический сервер будет использоваться
эксклюзивно для работы СУБД. Преимуществ от виртуализации -
возможности масштабирования, миграции и т.д. для работы СУБД не будет,
так как современные СУБД способны масштабироваться, кластеризоваться,
резервироваться и пр. своими средствами и более эффективно, чем это
сделает виртуальная машина.

- Различные web-приложения.

Это один из главных сценариев применения контейнеров/виртуализации на
уровне ОС.

- Windows системы для использования бухгалтерским отделом.

Вероятно, в этом сценарии предполагается организация виртуальных
рабочих столов. Система одна, и это Windows. Возможно, наиболее
экономичным вариантом будет паравиртуализация на основе Hyper-V.

- Системы, выполняющие высокопроизводительные расчеты на GPU.

Напрашивается использование физических серверов ради получения
максимальной производительности, однако есть смысл рассмотреть и
паравиртуализационные решения на основе NVIDIA Virtual Compute
Server. Возможно, это позволит повысить утилизацию GPU.

> Выберите подходящую систему управления виртуализацией для
> предложенного сценария. Детально опишите ваш выбор.

- 100 виртуальных машин на базе Linux и Windows, общие задачи, нет
  особых требований. Преимущественно Windows based инфраструктура,
  требуется реализация программных балансировщиков нагрузки,
  репликации данных и автоматизированного механизма создания резервных
  копий.
  
VMware vSphere с vCenter выполнит все эти требования. Несмотря на
преобладание Windows, сказать, что использование Hyper-V с System
Center будет эффективнее, трудно. С технической точки зрения оба
решения обеспечат нужные функции, однако как они будут отличаться по
стоимости, сказать практически невозможно, так как это зависит от
количества хостов, процессорных ядер и так далее. На выбор влияет
также наличие соответствующих специалистов.

Впрочем, в текущих российских условиях возможность эффективного
использования обоих решений выглядит сомнительно. Поэтому выбор
ограничен свободными решениями. Возможно, подойдет KVM + oVirt.

- Требуется наиболее производительное бесплатное open source решение
  для виртуализации небольшой (20-30 серверов) инфраструктуры на базе
  Linux и Windows виртуальных машин.
  
Вариантов здесь, в принципе, как и выше, два: Xen и KVM. Существенную
разницу в производительности вряд ли удастся заметить, хотя есть
мнение, что Xen будет чуть производительнее.

- Необходимо бесплатное, максимально совместимое и производительное
  решение для виртуализации Windows инфраструктуры.
  
Встроенный Hyper-V формально бесплатен, однако неизвестно, хватит ли
его функциональности в данном сценарии, и не придется ли устанавливать
платные компоненты. Если не хватит, придется вновь обращаться к KVM или Xen.

- Необходимо рабочее окружение для тестирования программного продукта
  на нескольких дистрибутивах Linux.
  
Контейнерное решение применить нельзя, так как дистрибутивы могут
иметь разные ядра. LXD в режиме виртуальной машины будет удобен
благодаря наличию готовой библиотеки дистрибутивов.

> Опишите возможные проблемы и недостатки гетерогенной среды
> виртуализации (использования нескольких систем управления
> виртуализацией одновременно) и что необходимо сделать для
> минимизации этих рисков и проблем. Если бы у вас был выбор, то
> создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ
> примерами.

Появление среды с несколькими гипервизорами и/или системами управления
часто вызвано следующими причинами.

1. Желанием сэкономить на лицензиях. Например, установка дорогих
   коммерческих гипервизоров в продакшен и более дешевых/бесплатных в
   разработке.
   
2. Требованиями приложений. Например, СУБД Oracle сертифицирована на
   работу только с Oracle VM на Linux и Hyper-V на Windows.

3. Требованиями совместимости оборудования.

4. Организационными причинами - например, слиянием компаний.

Применение нескольких гипервизоров, таким образом, позволяет повысить
степень виртуализации. Проблемами, однако, могут быть:

1. Трудность единого управления средой виртуализации из-за отсутствия
   универсальных систем управления, то есть невозможность
   единообразного резервного копирования, развертывания и пр. Хотя
   системы управления с поддержкой нескольких гипервизоров существуют,
   их применение может привести к еще большей фрагментации управления,
   когда работает несколько систем, каждая из которых управляет
   несколькими гипервизорами.

2. Снижение возможностей кластеризации и балансировки нагрузки из-за
   трудностей в переносе виртуальных машин между гипервизорами.
   
3. Сложность администрирования и необходимость иметь специалистов,
   знающих несколько систем.

Тем не менее, работа в гетерогенной среде может быть выгодна, в первую
очередь, если речь идет о коммерческих гипервизорах. Применение
нескольких свободных гипервизоров менее оправдано.
